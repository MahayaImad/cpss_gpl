<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <!-- === VUE FORMULAIRE ASSISTANT === -->
        <record id="view_gpl_setup_wizard_form" model="ir.ui.view">
            <field name="name">gpl.setup.wizard.form</field>
            <field name="model">gpl.setup.wizard</field>
            <field name="arch" type="xml">
                <form string="Assistant de Configuration GPL">

                    <!-- En-tête avec progression -->
                    <div class="alert alert-info">
                        <div class="row">
                            <div class="col-8">
                                <h4><i class="fa fa-magic" title=" "/> Configuration GPL CPSS</h4>
                                <p class="mb-0">Configurez votre système GPL en quelques étapes simples</p>
                            </div>
                            <div class="col-4 text-right">
                                <div class="progress" style="height: 20px;">
                                    <div class="progress-bar"
                                         modifiers="{'style': 'width: 25%' if step == 'company' else 'width: 50%' if step == 'workflow' else 'width: 75%' if step == 'notifications' else 'width: 100%'}">
                                        <span modifiers="{'invisible': [('step', '!=', 'company')]}">Étape 1/4</span>
                                        <span modifiers="{'invisible': [('step', '!=', 'workflow')]}">Étape 2/4</span>
                                        <span modifiers="{'invisible': [('step', '!=', 'notifications')]}">Étape 3/4</span>
                                        <span modifiers="{'invisible': [('step', '!=', 'complete')]}">Terminé</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Champs cachés -->
                    <field name="step" invisible="1"/>
                    <field name="from_settings" invisible="1"/>

                    <!-- === ÉTAPE 1: INFORMATIONS ENTREPRISE === -->
                    <div modifiers="{'invisible': [('step', '!=', 'company')]}">
                        <div class="alert alert-primary">
                            <h5><i class="fa fa-building" title=" "/> Étape 1: Informations de l'Entreprise</h5>
                            <p>Renseignez les informations de base de votre entreprise GPL.</p>
                        </div>

                        <group>
                            <group>
                                <field name="company_name" required="1"/>
                                <field name="company_license" required="1"/>
                                <field name="company_phone"/>
                            </group>
                            <group>
                                <field name="company_email"/>
                                <field name="company_address"/>
                            </group>
                        </group>
                    </div>

                    <!-- === ÉTAPE 2: WORKFLOW === -->
                    <div modifiers="{'invisible': [('step', '!=', 'workflow')]}">
                        <div class="alert alert-primary">
                            <h5><i class="fa fa-cogs" title=" "/> Étape 2: Configuration du Workflow</h5>
                            <p>Définissez comment vous souhaitez organiser vos processus GPL.</p>
                        </div>

                        <group>
                            <group string="Processus">
                                <field name="use_advanced_workflow"/>
                                <field name="require_appointment"/>
                                <field name="default_warranty_months"/>
                            </group>
                            <group string="Réservoirs">
                                <field name="reservoir_test_frequency"/>
                                <field name="reservoir_max_age"/>
                            </group>
                        </group>

                        <div class="alert alert-info mt16">
                            <strong>Recommandations :</strong>
                            <ul>
                                <li><strong>Workflow simple</strong> : Pour les petites structures (1-3 techniciens)</li>
                                <li><strong>Workflow avancé</strong> : Pour les structures importantes avec validation hiérarchique</li>
                                <li><strong>Tests réservoirs</strong> : 5 ans selon la réglementation française</li>
                            </ul>
                        </div>
                    </div>

                    <!-- === ÉTAPE 3: NOTIFICATIONS === -->
                    <div modifiers="{'invisible': [('step', '!=', 'notifications')]}">
                        <div class="alert alert-primary">
                            <h5><i class="fa fa-bell" title=" "/> Étape 3: Notifications et Alertes</h5>
                            <p>Configurez les alertes pour ne jamais manquer une échéance importante.</p>
                        </div>

                        <group>
                            <group>
                                <field name="enable_notifications"/>
                                <field name="notification_email" modifiers="{'required': [('enable_notifications', '=', True)]}"/>
                            </group>
                            <group>
                                <field name="notification_test_days"/>
                                <field name="create_demo_data"/>
                            </group>
                        </group>

                        <div class="alert alert-warning mt16" modifiers="{'invisible': [('enable_notifications', '=', False)]}">
                            <strong>Important :</strong> Les notifications vous aideront à anticiper :
                            <ul>
                                <li>Les dates d'expiration des réservoirs</li>
                                <li>Les contrôles techniques à effectuer</li>
                                <li>Les rendez-vous programmés</li>
                            </ul>
                        </div>
                    </div>

                    <!-- === ÉTAPE 4: TERMINÉ === -->
                    <div modifiers="{'invisible': [('step', '!=', 'complete')]}">
                        <div class="alert alert-success">
                            <h5><i class="fa fa-check-circle" title=" "/> Configuration Terminée !</h5>
                            <p>Votre système GPL CPSS est maintenant configuré et prêt à être utilisé.</p>
                        </div>

                        <div class="row">
                            <div class="col-6">
                                <div class="card">
                                    <div class="card-body text-center">
                                        <i class="fa fa-car fa-3x text-primary mb-3" title=" "/>
                                        <h6>Prochaines Étapes</h6>
                                        <p class="small">
                                            1. Créer vos premiers véhicules<br/>
                                            2. Configurer vos réservoirs<br/>
                                            3. Planifier vos interventions
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="card">
                                    <div class="card-body text-center">
                                        <i class="fa fa-life-ring fa-3x text-info mb-3" title=" "/>
                                        <h6>Besoin d'Aide ?</h6>
                                        <p class="small">
                                            Documentation : docs.cedarpss.com<br/>
                                            Support : support@cedarpss.com<br/>
                                            Téléphone : +213 XXX XXX XXX
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- === BOUTONS DE NAVIGATION === -->
                    <footer>
                        <div class="row">
                            <div class="col-6">
                                <button string="Précédent"
                                        name="action_previous_step"
                                        type="object"
                                        class="btn btn-secondary"
                                        modifiers="{'invisible': [('step', 'in', ['company', 'complete'])]}"/>
                            </div>
                            <div class="col-6 text-right">
                                <button string="Suivant"
                                        name="action_next_step"
                                        type="object"
                                        class="btn btn-primary"
                                        modifiers="{'invisible': [('step', 'in', ['complete'])]}"/>

                                <button string="Terminer"
                                        name="action_finish"
                                        type="object"
                                        class="btn btn-success"
                                        modifiers="{'invisible': [('step', '!=', 'complete')]}"/>

                                <button string="Annuler"
                                        special="cancel"
                                        class="btn btn-light ml-2"/>
                            </div>
                        </div>
                    </footer>

                </form>
            </field>
        </record>

        <!-- === ACTION === -->
        <record id="action_gpl_setup_wizard" model="ir.actions.act_window">
            <field name="name">Assistant de Configuration GPL</field>
            <field name="res_model">gpl.setup.wizard</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
            <field name="view_id" ref="view_gpl_setup_wizard_form"/>
        </record>

    </data>
</odoo>
